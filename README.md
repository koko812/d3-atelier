# ❄️ Fractal Playground — D3.jsで描く自己相似図形たち

インタラクティブに変化する **Koch曲線 / 雪片** を中心に、フラクタル図形の幾何構造・ズーム表現・色彩・UIを組み合わせた実験的ビジュアライゼーションプロジェクト。

[![Image from Gyazo](https://i.gyazo.com/a7b27b8b1a24de41ead46d849ebadafb.png)](https://gyazo.com/a7b27b8b1a24de41ead46d849ebadafb)


---

## 🚀 機能一覧

* ✅ **Koch Curve** / **Koch Snowflake** の切り替え
* ✅ 再帰の深さ（depth）をステップごとに増加可能
* ✅ SVGベースのズームイン/アウト（非スケーリングストローク対応）
* ✅ ズーム位置をマウスクリックで指定可能
* ✅ 見た目を乱さずに滑らかに変形する描画処理
* ✅ 色彩・形状・出力品質のバグ修正と理論整備
* ✅ **感染伝播シミュレーションのサンプル実装**を含む（D3 Force Layout + アニメーション）

---

## 🧠 技術スタック・設計思想

| 要素             | 内容                                                             |
| -------------- | -------------------------------------------------------------- |
| 🎨 D3.js       | SVG要素のデータ駆動生成とズーム処理に使用                                         |
| 💡 SVG + `<g>` | グループ単位でtransformを扱い、ズーム/パンをスムーズに構築                             |
| 📐 幾何ロジック      | ベクトル回転による三角形頂点の導出、再帰的線分分割、非スケーリングストローク対応                       |
| 🔁 描画更新        | `.flatMap()` による線分の増殖処理。`drawKoch(svg, { depth, mode })` で再描画  |
| 🧩 モジュール構成     | `src/shapes/`（構造ロジック）と `src/ui/`（イベント処理）を分離                    |
| 🔧 構成自動化       | `setup_structure.sh` でディレクトリ初期化。`allout.sh` により全ファイルを1つに統合出力可能 |

---

## 🗂️ ディレクトリ構成（主要部のみ）

```
.
├── koch.html                   # メインUI
├── src/
│   ├── shapes/
│   │   └── koch.js             # Koch曲線の描画ロジック
│   └── ui/
│       └── koch_buttons.js     # UIイベント処理（ボタンなど）
├── dist/
│   └── combined_output.txt     # 全コード出力ログ（allout.sh）
├── LEARNED.md                  # 技術ログ・バグ履歴・数式導出など詳細に記述
├── setup_structure.sh          # 構成初期化スクリプト
├── infection_sim.html          # 感染シミュレーション表示用HTML
├── src/shapes/infection.js     # D3 force layout による感染処理
└── README.md                   # このファイル
```

---

## ✨ 今後の展開アイデア

* 🎮 depthスライダーによるリアルタイム制御
* 🎨 カラーテーマの切り替え（昼・夜・ネオン・和風 など）
* 🌀 Dragon Curve や Sierpinski への対応
* 🌱 Perlin Noise による自然な揺らぎの導入
* 🎥 自動再生モード（depthが一定間隔で増減）
* 🖼 SVG出力ボタン（保存・印刷用）
* 🧪 **感染伝播モデルの拡張**（回復・再感染・ログ可視化・粒子アニメ追加）

---

## 📘 学習ログ・開発記録

詳しくは `LEARNED.md` を参照。
バグの発見・回避方法、回転行列の導出、各depthにおける描画性能の評価など、**試行錯誤の過程を余さず記録**しています。

---

## 📜 ライセンス

MIT License

---

## 🙌 作者よりひとこと

> 「フラクタルは構造を持った混沌。アートと数学が同居する場所。」
> 本プロジェクトは、そうした“構造の美”を追求する実験場です。
> ご意見・コントリビュート大歓迎！
